è¿™æ˜¯æœºå™¨å­¦ä¹ å®žæˆ˜ä¸­æœ€ç»å…¸ã€ä¹Ÿæ˜¯æœ€æ¿€åŠ¨äººå¿ƒçš„ä¸€ç« ã€‚

æˆ‘ä»¬è¦æ‹¿ Scikit-Learn ä¸­æœ€åŸºç¡€çš„**é€»è¾‘å›žå½’ (Logistic Regression)** ç®—æ³•ï¼ŒåŽ»æŒ‘æˆ˜æ•°æ®ç§‘å­¦ç•Œçš„â€œHello Worldâ€â€”â€”**æ³°å¦å°¼å…‹å·ç”Ÿå­˜é¢„æµ‹**ã€‚

åˆ«è¢«å®ƒçš„åå­—éª—äº†ã€‚è™½ç„¶å®ƒå«â€œå›žå½’â€ï¼Œä½†å®ƒå…¶å®žæ˜¯**åˆ†ç±»ç®—æ³•**çš„å¼€å±±é¼»ç¥–ã€‚

---

# ç¬¬ 9 ç« ï¼šç¬¬ä¸€åœºæˆ˜å½¹ï¼šé€»è¾‘å›žå½’ä¸Žæ³°å¦å°¼å…‹å·

## 9.1 ç†è®ºé€Ÿé€šï¼šä¸ºä»€ä¹ˆä¸èƒ½ç”¨çº¿æ€§å›žå½’ï¼Ÿ

æˆ‘ä»¬åœ¨ç¬¬ 6 ç« å­¦äº†çº¿æ€§å›žå½’ï¼Œå®ƒæ˜¯ç”»ä¸€æ¡ç›´çº¿åŽ»æ‹Ÿåˆæ•°æ®ã€‚
ä½†åœ¨**äºŒåˆ†ç±»é—®é¢˜**ï¼ˆé¢„æµ‹ ç”Ÿå­˜/æ­»äº¡ï¼Œä¹Ÿå°±æ˜¯ 1/0ï¼‰ä¸­ï¼Œçº¿æ€§å›žå½’ä¼šâ€œæ°´åœŸä¸æœâ€ã€‚

### âŒ çº¿æ€§å›žå½’çš„å°´å°¬

å‡è®¾æˆ‘ä»¬è¦é¢„æµ‹â€œç”Ÿå­˜æ¦‚çŽ‡â€ã€‚

* å¦‚æžœç”¨çº¿æ€§å›žå½’ç”»ç›´çº¿ï¼Œå½“ç‰¹å¾å¾ˆå¤§æ—¶ï¼Œé¢„æµ‹å€¼å¯èƒ½ä¼šå˜æˆ ï¼ˆ150% å­˜æ´»ï¼Ÿï¼‰æˆ–è€… ï¼ˆ-20% å­˜æ´»ï¼Ÿï¼‰ã€‚
* **æ¦‚çŽ‡ä¸å¯èƒ½è¶…è¿‡ 100%ï¼Œä¹Ÿä¸å¯èƒ½ä½ŽäºŽ 0%ã€‚**

### âœ… é€»è¾‘å›žå½’çš„é­”æ³•ï¼šSigmoid å‡½æ•°

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ•°å­¦å®¶å¼•å…¥äº†ä¸€ä¸ªç¥žå¥‡çš„å‡½æ•°ï¼š**Sigmoid å‡½æ•°**ï¼ˆS åž‹å‡½æ•°ï¼‰ã€‚
å®ƒåƒä¸€ä¸ªâ€œåŽ‹ç¼©æœºâ€ï¼ŒæŠŠä»»ä½•æ•°å€¼ï¼ˆè´Ÿæ— ç©·åˆ°æ­£æ— ç©·ï¼‰éƒ½å¼ºè¡ŒåŽ‹ç¼©åˆ° **0 åˆ° 1 ä¹‹é—´**ã€‚

* **å…¬å¼:** 
* **å½¢çŠ¶:** åƒä¸€ä¸ª S å½¢çš„æ»‘æ¢¯ã€‚
* **å†³ç­–è¾¹ç•Œ:**
* å¦‚æžœç®—å‡ºæ¥çš„æ¦‚çŽ‡   åˆ¤ä¸º **1 (ç”Ÿ)**ã€‚
* å¦‚æžœç®—å‡ºæ¥çš„æ¦‚çŽ‡   åˆ¤ä¸º **0 (æ­»)**ã€‚



> **ðŸŒ° æ¡ˆä¾‹ï¼šè°ƒå…‰å°ç¯**
> * **çº¿æ€§å›žå½’** å°±åƒé‚£ç§è€å¼å¼€å…³ï¼Œè¦ä¹ˆå…¨äº®ï¼Œè¦ä¹ˆå…¨ç­ï¼Œå¾ˆéš¾æŽ§åˆ¶ä¸­é—´çŠ¶æ€ã€‚
> * **é€»è¾‘å›žå½’** å°±åƒä¸€ä¸ª**æ— çº§è°ƒå…‰çš„æ—‹é’®**ã€‚å®ƒå‘Šè¯‰ä½ ç¯çš„äº®åº¦æ˜¯ 80% è¿˜æ˜¯ 20%ã€‚æœ€åŽä½ å¯ä»¥è®¾å®šä¸€ä¸ªè§„çŸ©ï¼šåªè¦äº®åº¦è¶…è¿‡ 50% å°±å½“å®ƒæ˜¯å¼€ç€çš„ã€‚
> 
> 

---

## 9.2 å®žæˆ˜èƒŒæ™¯ï¼šæ³°å¦å°¼å…‹å·ä¹‹è°œ

> **ðŸŽ¬ å‰§æœ¬:**
> 1912 å¹´ï¼Œæ³°å¦å°¼å…‹å·æ²‰æ²¡ã€‚æœ‰äº›ç¾¤ä½“ï¼ˆå¦‚å¦‡å¥³ã€å„¿ç«¥ã€å¤´ç­‰èˆ±ä¹˜å®¢ï¼‰çš„ç”Ÿå­˜çŽ‡ä¼¼ä¹Žæ›´é«˜ã€‚
> **ä»»åŠ¡:** ç»™å®šä¸€åä¹˜å®¢çš„ä¿¡æ¯ï¼ˆå¹´é¾„ã€æ€§åˆ«ã€ç¥¨ä»·ã€èˆ±ä½ï¼‰ï¼Œè¯· AI åˆ¤æ–­ï¼š**ä»–/å¥¹èƒ½æ´»ä¸‹æ¥å—ï¼Ÿ**

æˆ‘ä»¬å°†ä½¿ç”¨ Pandas åšæ¸…æ´—ï¼ŒSeaborn åšåˆ†æžï¼ŒScikit-Learn åšé¢„æµ‹ã€‚

---

## 9.3 Step 1: æ•°æ®åŠ è½½ä¸ŽåˆæŽ¢

Scikit-Learn å’Œ Seaborn éƒ½å†…ç½®äº†è¿™ä¸ªç»å…¸æ•°æ®é›†ï¼Œæˆ‘ä»¬ç›´æŽ¥åŠ è½½ã€‚

```python
import seaborn as sns
import pandas as pd
import matplotlib.pyplot as plt

# 1. åŠ è½½æ•°æ®
# raw_df æ˜¯åŽŸå§‹æ•°æ®
raw_df = sns.load_dataset('titanic')

# 2. çœ‹å‰ 5 è¡Œ
print(raw_df.head())

```

**å…³é”®å­—æ®µè§£è¯»:**

* `survived`: 1=ç”Ÿ, 0=æ­» (**è¿™æ˜¯æˆ‘ä»¬è¦é¢„æµ‹çš„ y**)
* `pclass`: èˆ±ä½ç­‰çº§ (1=å¤´ç­‰, 2=äºŒç­‰, 3=ä¸‰ç­‰)
* `sex`: æ€§åˆ« (male/female)
* `age`: å¹´é¾„
* `fare`: ç¥¨ä»·

---

## 9.4 Step 2: æ•°æ®æ¸…æ´— (Preprocessing)

è¿™æ˜¯æœ€ç¹çä½†ä¹Ÿæœ€å…³é”®çš„ä¸€æ­¥ã€‚æˆ‘ä»¬éœ€è¦å¤„ç†**ç¼ºå¤±å€¼**å’Œ**æ–‡æœ¬ç‰¹å¾**ã€‚

```python
# 1. ç­›é€‰ç‰¹å¾
# æˆ‘ä»¬åªé€‰å‡ ä¸ªæ ¸å¿ƒç‰¹å¾ï¼ŒæŠŠé‚£äº›éš¾å¤„ç†çš„ï¼ˆå¦‚ cabin èˆ¹èˆ±å·ï¼‰å…ˆæ‰”æŽ‰
cols = ['survived', 'pclass', 'sex', 'age', 'fare']
df = raw_df[cols].copy()

# 2. å¤„ç†ç¼ºå¤±å€¼ (Age)
# æ£€æŸ¥ç©ºå€¼
print("ç©ºå€¼æƒ…å†µ:\n", df.isnull().sum())
# å‘çŽ° 'age' ç¼ºäº†ä¸å°‘ã€‚æˆ‘ä»¬ç”¨â€œä¸­ä½æ•°â€æ¥å¡«è¡¥ï¼ˆæ¯”å¹³å‡å€¼æ›´æŠ—å¹²æ‰°ï¼‰
df['age'].fillna(df['age'].median(), inplace=True)

# 3. å¤„ç†æ–‡æœ¬ç‰¹å¾ (Sex)
# æœºå™¨ä¸è®¤è¯† 'male'/'female'ã€‚æˆ‘ä»¬ç”¨ Pandas çš„ get_dummies åšç‹¬çƒ­ç¼–ç 
# drop_first=True æ˜¯ä¸ªå°æŠ€å·§ï¼šå› ä¸ºåªæœ‰ç”·/å¥³ï¼Œæ‰€ä»¥â€œä¸æ˜¯å¥³â€å°±æ˜¯â€œç”·â€ï¼Œåªç•™ä¸€åˆ—å³å¯ï¼Œé˜²æ­¢å¤šé‡å…±çº¿æ€§
df = pd.get_dummies(df, columns=['sex'], drop_first=True)

print("æ¸…æ´—åŽçš„æ•°æ®:\n", df.head())

```

*æ­¤æ—¶ï¼Œ`sex_female` è¿™ä¸€åˆ—ä¸­ï¼Œ1 ä»£è¡¨å¥³æ€§ï¼Œ0 ä»£è¡¨ç”·æ€§ã€‚*

---

## 9.5 Step 3: è®­ç»ƒæ¨¡åž‹ (Training)

æ•°æ®å¹²å‡€äº†ï¼Œå¼€å§‹å–‚ç»™æ¨¡åž‹ã€‚

```python
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression

# 1. å‡†å¤‡ X å’Œ y
X = df.drop(columns=['survived']) # é™¤äº† survived éƒ½æ˜¯ç‰¹å¾
y = df['survived']                # survived æ˜¯ç­”æ¡ˆ

# 2. åˆ‡åˆ† è®­ç»ƒé›†/æµ‹è¯•é›†
# 80% å­¦ä¹ ï¼Œ20% è€ƒè¯•
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 3. å®žä¾‹åŒ–ä¸Žè®­ç»ƒ
# max_iter=1000 æ˜¯ä¸ºäº†é˜²æ­¢æŠ¥é”™ï¼Œç»™æ¨¡åž‹å¤šä¸€ç‚¹æ—¶é—´åŽ»å¯»æ‰¾æœ€ä¼˜è§£
model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)

print("æ¨¡åž‹è®­ç»ƒå®Œæ¯•ï¼")

```

---

## 9.6 Step 4: é¢„æµ‹ä¸Žè§£é‡Š (Prediction)

è¿™å°±æ˜¯é€»è¾‘å›žå½’æœ€å¼ºå¤§çš„åœ°æ–¹ï¼š**å¯è§£é‡Šæ€§**ã€‚æˆ‘ä»¬ä¸ä»…èƒ½é¢„æµ‹ç”Ÿæ­»ï¼Œè¿˜èƒ½çŸ¥é“**ä¸ºä»€ä¹ˆ**ã€‚

### ðŸ”® é¢„æµ‹ Jack å’Œ Rose çš„å‘½è¿

å‡è®¾ç”µå½±é‡Œçš„ä¸¤ä½ä¸»è§’ä¹Ÿåœ¨èˆ¹ä¸Šï¼Œæˆ‘ä»¬æ‰‹åŠ¨æž„é€ æ•°æ®æ¥æµ‹è¯•æ¨¡åž‹ã€‚

* **Rose:** 1ç­‰èˆ±, 22å², ç¥¨ä»·500, å¥³æ€§(sex_female=1)
* **Jack:** 3ç­‰èˆ±, 20å², ç¥¨ä»·5, ç”·æ€§(sex_female=0)

```python
# æž„é€ æ•°æ® (é¡ºåºå¿…é¡»å’Œ X_train ä¸€æ ·: pclass, age, fare, sex_female)
rose = [[1, 22, 500, 1]]
jack = [[3, 20, 5, 0]]

# é¢„æµ‹ç»“æžœ
print("Rose ç”Ÿå­˜é¢„æµ‹:", model.predict(rose)) # è¾“å‡º [1] (ç”Ÿ)
print("Jack ç”Ÿå­˜é¢„æµ‹:", model.predict(jack)) # è¾“å‡º [0] (æ­»)

# æŸ¥çœ‹ç”Ÿå­˜æ¦‚çŽ‡ (predict_proba)
# è¾“å‡ºæ ¼å¼: [æ­»äº¡æ¦‚çŽ‡, ç”Ÿå­˜æ¦‚çŽ‡]
print("Rose ç”Ÿå­˜æ¦‚çŽ‡:", model.predict_proba(rose)[0][1]) 
print("Jack ç”Ÿå­˜æ¦‚çŽ‡:", model.predict_proba(jack)[0][1])

```

*ä½ ä¼šå‘çŽ° Rose çš„ç”Ÿå­˜æ¦‚çŽ‡æžé«˜ï¼ˆ>90%ï¼‰ï¼Œè€Œ Jack å¾ˆä½Žï¼ˆ<15%ï¼‰ã€‚è¿™ç¬¦åˆåŽ†å²äº‹å®žï¼šLady first (å¥³å£«ä¼˜å…ˆ) å’Œå¤´ç­‰èˆ±ä¼˜å…ˆã€‚*

### ðŸ” ä¸ºä»€ä¹ˆï¼Ÿçœ‹æƒé‡ (Coefficients)

```python
# æŸ¥çœ‹ç‰¹å¾æƒé‡
weights = pd.DataFrame({
    'ç‰¹å¾': X.columns,
    'æƒé‡': model.coef_[0]
})
print(weights.sort_values(by='æƒé‡', ascending=False))

```

**ç»“æžœè§£è¯»:**

* `sex_female` çš„æƒé‡é€šå¸¸æ˜¯**æ­£æ•°ä¸”å¾ˆå¤§**ï¼ˆæ¯”å¦‚ +2.5ï¼‰ï¼šè¯´æ˜Ž**å¥³æ€§**æ˜¯ç”Ÿå­˜çš„æœ€å¼ºç‰¹å¾ã€‚
* `pclass` çš„æƒé‡é€šå¸¸æ˜¯**è´Ÿæ•°**ï¼ˆæ¯”å¦‚ -1.1ï¼‰ï¼šè¯´æ˜Ž**èˆ±ä½ç­‰çº§æ•°å­—è¶Šå¤§ï¼ˆ3ç­‰èˆ±ï¼‰ï¼Œç”Ÿå­˜æ¦‚çŽ‡è¶Šä½Ž**ã€‚
* `age` çš„æƒé‡é€šå¸¸æ˜¯**å¾®å°çš„è´Ÿæ•°**ï¼šè¯´æ˜Žå¹´çºªè¶Šå¤§è¶Šä¸å®¹æ˜“æ´»ï¼ˆä¼˜å…ˆæ•‘å°å­©ï¼‰ã€‚

---

## 9.7 Step 5: ç®€å•çš„æ¨¡åž‹è¯„ä¼°

æœ€åŽï¼Œçœ‹çœ‹æ¨¡åž‹åœ¨æµ‹è¯•é›†ä¸Šçš„æ€»ä½“è¡¨çŽ°ã€‚

```python
# å‡†ç¡®çŽ‡ (Accuracy)
score = model.score(X_test, y_test)
print(f"æ¨¡åž‹æµ‹è¯•é›†å‡†ç¡®çŽ‡: {score:.2%}")

```

*é€šå¸¸è¿™ä¸ªç®€å•çš„æ¨¡åž‹èƒ½è¾¾åˆ° 78% - 81% çš„å‡†ç¡®çŽ‡ã€‚*

---

## æœ¬ç« å°ç»“

æˆ‘ä»¬ç”¨é€»è¾‘å›žå½’å®Œæˆäº†ç¬¬ä¸€æ¬¡åˆ†ç±»ä»»åŠ¡å®žæˆ˜ï¼š

1. **Sigmoid å‡½æ•°**æŠŠå›žå½’å˜æˆäº†åˆ†ç±»ã€‚
2. **ç‹¬çƒ­ç¼–ç **å¤„ç†äº†æ€§åˆ«ç‰¹å¾ã€‚
3. **æƒé‡åˆ†æž**æ­ç¤ºäº†â€œå¥³å£«ä¼˜å…ˆâ€å’Œâ€œé‡‘é’±çš„åŠ›é‡â€ã€‚

**ðŸ¤” æ€è€ƒé¢˜ï¼š**
å¦‚æžœæ¨¡åž‹çš„å‡†ç¡®çŽ‡æ˜¯ 80%ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå¥½æ¨¡åž‹å—ï¼Ÿ

* å¦‚æžœè¿™è‰˜èˆ¹ä¸Š 99% çš„äººéƒ½æ­»äº†ï¼Œæˆ‘çš„æ¨¡åž‹åªè¦**å…¨çŒœæ­»**ï¼Œå‡†ç¡®çŽ‡å°±èƒ½è¾¾åˆ° 99%ï¼é‚£æˆ‘çš„æ¨¡åž‹å²‚ä¸æ˜¯æ¯”è®­ç»ƒå‡ºæ¥çš„ 80% è¿˜è¦å¥½ï¼Ÿä½†å®ƒæœ‰æ„ä¹‰å—ï¼Ÿ

